本项目为 《面向近端手持通信设备的话者语音增强方法研究》 大创项目的安卓部署代码。部署采用onnx Runtime方案。

assets 文件夹内存放spex+ 2spk模型，训练自[wesep](https://github.com/wenet-e2e/wesep)，导出为onnx。你可以直接用本仓库内准备好的onnx模型。

本项目并未完全完成，存在以下问题：

1. 目前模型仅对`.wav`格式音频分离效果较好，且嵌入音频要求尽量无混响。
2. 嵌入音频不能过长。超过`20s`可能会报`std::bad_allocate`
3. 目前在 `Android 14` 及以上版本的手机上无法运行，`Android 7` 和 `Android 12` 版本的手机可以运行。其余版本情况未知。
4. 加载文件路径为`null`为正常现象，以能否用播放按钮播放音频为准。
5. 文件存储权限获取逻辑有些怪异（虽然能用）。
6. 其他未知问题

如果你要使用本项目，请注意以下细节：

1. 基于我们训练的数据集，我们把所有输入音频强制转化为`16k`采样率,单声道。
2. 输入的混合音频被切割为**定长**后送给onnx模型推理。这个定长输入由导出onnx时所选的参数决定。如果你要从`wesep`项目中导出可供使用的2spk onnx模型，请注意只有嵌入音频的长度可以为动态轴，**混合音频的长度和batch_size不可以作为动态轴**。
3. 待补充